package com.xuyuan.pager.action;import java.util.Collection;import org.springframework.beans.factory.annotation.Autowired;import org.springframework.context.annotation.Scope;import org.springframework.stereotype.Controller;import com.opensymphony.xwork2.ActionSupport;import com.xuyuan.pager.entity.Books;import com.xuyuan.pager.model.Pager;import com.xuyuan.pager.model.PagerService;import com.xuyuan.pager.service.IBooksService;/** * 演示带查询条件的分页查询: 	http://localhost:8888/start_j2ee/booklist.action * @author Administrator * */public class BookAction extends ActionSupport{	private IBooksService booksService;    private Books book;    protected Integer bookId;        private PagerService pagerService;    private Pager pager;    protected String currentPage;    protected String pagerMethod;    protected String totalRows;        protected Collection availableItems;        protected String queryName;    protected String queryValue;    protected String searchName;    protected String searchValue;    protected String queryMap;        public String list() throws Exception {        if(queryMap ==null||queryMap.equals("")){                    }else{            String[] str=queryMap.split("~");            this.setQueryName(str[0]);            this.setQueryValue(str[1]);        }                System.out.println("asd"+this.getQueryValue());        int totalRow=booksService.getRows(this.getQueryName(),this.getQueryValue());        pager=pagerService.getPager(this.getCurrentPage(), this.getPagerMethod(), totalRow);        this.setCurrentPage(String.valueOf(pager.getCurrentPage()));        this.setTotalRows(String.valueOf(totalRow));        availableItems=booksService.getBooks(this.getQueryName(),this.getQueryValue(),pager.getPageSize(), pager.getStartRow());                this.setQueryName(this.getQueryName());        this.setQueryValue(this.getQueryValue());                this.setSearchName(this.getQueryName());        this.setSearchValue(this.getQueryValue());                return SUCCESS;             }        public String load() throws Exception {    	book = booksService.getBook(bookId);//        if(bookId!=null)//            book = booksService.getBook(bookId);//        else//            bookId=booksService.getMaxID();        return SUCCESS;    }        public String save() throws Exception {        if(this.getBook().getBookPrice().equals("")){            this.getBook().setBookPrice("0.0");        }                Integer id=this.getBook().getBookId();        Books book=booksService.getBook(id);                                if(book == null)            booksService.addBook(this.getBook());        else            booksService.updateBook(this.getBook());                this.setQueryName(this.getQueryName());        this.setQueryValue(this.getQueryValue());                if(this.getQueryName()==null||this.getQueryValue()==null||this.getQueryName().equals("")||this.getQueryValue().equals("")){                    }else{            queryMap=this.getQueryName()+"~"+this.getQueryValue();        }                        return SUCCESS;    }        public String delete() throws Exception {        booksService.deleteBook(this.getBookId());                if(this.getQueryName()==null||this.getQueryValue()==null||this.getQueryName().equals("")||this.getQueryValue().equals("")){                    }else{            queryMap=this.getQueryName()+"~"+this.getQueryValue();        }        return SUCCESS;    }            public Books getBook() {        return book;    }    public void setBook(Books book) {        this.book = book;    }    public IBooksService getBooksService() {        return booksService;    }    public void setBooksService(IBooksService booksService) {        this.booksService = booksService;    }    public Collection getAvailableItems() {        return availableItems;    }    public String getCurrentPage() {        return currentPage;    }    public void setCurrentPage(String currentPage) {        this.currentPage = currentPage;    }    public String getPagerMethod() {        return pagerMethod;    }    public void setPagerMethod(String pagerMethod) {        this.pagerMethod = pagerMethod;    }    public Pager getPager() {        return pager;    }    public void setPager(Pager pager) {        this.pager = pager;    }    public String getTotalRows() {        return totalRows;    }    public void setTotalRows(String totalRows) {        this.totalRows = totalRows;    }            public Integer getBookId() {		return bookId;	}	public void setBookId(Integer bookId) {		this.bookId = bookId;	}	public String getQueryName() {        return queryName;    }    public void setQueryName(String queryName) {        this.queryName = queryName;    }    public String getQueryValue() {        return queryValue;    }    public void setQueryValue(String queryValue) {        this.queryValue = queryValue;    }        public String getSearchName() {        return searchName;    }    public void setSearchName(String searchName) {        this.searchName = searchName;    }    public String getSearchValue() {        return searchValue;    }    public void setSearchValue(String searchValue) {        this.searchValue = searchValue;    }        public String getQueryMap() {        return queryMap;    }    public void setQueryMap(String queryMap) {        this.queryMap = queryMap;    }        public PagerService getPagerService() {        return pagerService;    }    public void setPagerService(PagerService pagerService) {        this.pagerService = pagerService;    }  }